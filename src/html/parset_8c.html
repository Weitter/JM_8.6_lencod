<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: parset.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">parset.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Picture and Sequence Parameter set generation and handling.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;memory.h&gt;</code><br />
<code>#include &lt;malloc.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &quot;global.h&quot;</code><br />
<code>#include &quot;contributors.h&quot;</code><br />
<code>#include &quot;parsetcommon.h&quot;</code><br />
<code>#include &quot;nalu.h&quot;</code><br />
<code>#include &quot;parset.h&quot;</code><br />
<code>#include &quot;fmo.h&quot;</code><br />
<code>#include &quot;vlc.h&quot;</code><br />
<code>#include &quot;mbuffer.h&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4f3d2bb7e7970f24b1f5c2e86aefabcb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#a4f3d2bb7e7970f24b1f5c2e86aefabcb">GenerateParameterSets</a> ()</td></tr>
<tr class="memdesc:a4f3d2bb7e7970f24b1f5c2e86aefabcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">generates a sequence and picture parameter set and stores these in global active_sps and active_pps  <a href="parset_8c.html#a4f3d2bb7e7970f24b1f5c2e86aefabcb">More...</a><br /></td></tr>
<tr class="separator:a4f3d2bb7e7970f24b1f5c2e86aefabcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a31602a3ebbedf60e8963bf1bd8e1be"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#a2a31602a3ebbedf60e8963bf1bd8e1be">FreeParameterSets</a> ()</td></tr>
<tr class="memdesc:a2a31602a3ebbedf60e8963bf1bd8e1be"><td class="mdescLeft">&#160;</td><td class="mdescRight">frees global parameter sets active_sps and active_pps  <a href="parset_8c.html#a2a31602a3ebbedf60e8963bf1bd8e1be">More...</a><br /></td></tr>
<tr class="separator:a2a31602a3ebbedf60e8963bf1bd8e1be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2758c89416acfb769f1fdd74e750ee1b"><td class="memItemLeft" align="right" valign="top">NALU_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#a2758c89416acfb769f1fdd74e750ee1b">GenerateSeq_parameter_set_NALU</a> ()</td></tr>
<tr class="memdesc:a2758c89416acfb769f1fdd74e750ee1b"><td class="mdescLeft">&#160;</td><td class="mdescRight">int GenerateSeq_parameter_set_NALU ();  <a href="parset_8c.html#a2758c89416acfb769f1fdd74e750ee1b">More...</a><br /></td></tr>
<tr class="separator:a2758c89416acfb769f1fdd74e750ee1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cf018768a067fec68b97e027ecd3819"><td class="memItemLeft" align="right" valign="top">NALU_t *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#a4cf018768a067fec68b97e027ecd3819">GeneratePic_parameter_set_NALU</a> ()</td></tr>
<tr class="memdesc:a4cf018768a067fec68b97e027ecd3819"><td class="mdescLeft">&#160;</td><td class="mdescRight">NALU_t *GeneratePic_parameter_set_NALU ();.  <a href="parset_8c.html#a4cf018768a067fec68b97e027ecd3819">More...</a><br /></td></tr>
<tr class="separator:a4cf018768a067fec68b97e027ecd3819"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c2ef325f78e6851fba3ed4032be8c50"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#a8c2ef325f78e6851fba3ed4032be8c50">FillParameterSetStructures</a> (seq_parameter_set_rbsp_t *sps, pic_parameter_set_rbsp_t *pps)</td></tr>
<tr class="memdesc:a8c2ef325f78e6851fba3ed4032be8c50"><td class="mdescLeft">&#160;</td><td class="mdescRight">FillParameterSetStructures: extracts info from global variables and generates a picture and sequence parameter set structure.  <a href="parset_8c.html#a8c2ef325f78e6851fba3ed4032be8c50">More...</a><br /></td></tr>
<tr class="separator:a8c2ef325f78e6851fba3ed4032be8c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54abd2ecf70d3d51ef613387e5dba91"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#aa54abd2ecf70d3d51ef613387e5dba91">GenerateSeq_parameter_set_rbsp</a> (seq_parameter_set_rbsp_t *sps, char *rbsp)</td></tr>
<tr class="memdesc:aa54abd2ecf70d3d51ef613387e5dba91"><td class="mdescLeft">&#160;</td><td class="mdescRight">int GenerateSeq_parameter_set_rbsp (seq_parameter_set_rbsp_t *sps, char *rbsp);  <a href="parset_8c.html#aa54abd2ecf70d3d51ef613387e5dba91">More...</a><br /></td></tr>
<tr class="separator:aa54abd2ecf70d3d51ef613387e5dba91"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af4306d13e672a745606a9793df4b18d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="parset_8c.html#af4306d13e672a745606a9793df4b18d5">GeneratePic_parameter_set_rbsp</a> (pic_parameter_set_rbsp_t *pps, char *rbsp)</td></tr>
<tr class="memdesc:af4306d13e672a745606a9793df4b18d5"><td class="mdescLeft">&#160;</td><td class="mdescRight">int GeneratePic_parameter_set_rbsp (pic_parameter_set_rbsp_t *sps, char *rbsp);  <a href="parset_8c.html#af4306d13e672a745606a9793df4b18d5">More...</a><br /></td></tr>
<tr class="separator:af4306d13e672a745606a9793df4b18d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a6cb19d3cc47256c79bf137a84f316255"><td class="memItemLeft" align="right" valign="top"><a id="a6cb19d3cc47256c79bf137a84f316255"></a>
ColocatedParams *&#160;</td><td class="memItemRight" valign="bottom"><b>Co_located</b></td></tr>
<tr class="separator:a6cb19d3cc47256c79bf137a84f316255"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Picture and Sequence Parameter set generation and handling. </p>
<p><a class="el" href="parset_8c.html" title="Picture and Sequence Parameter set generation and handling.">parset.c</a> </p><dl class="section date"><dt>Date</dt><dd>25 November 2002 </dd></dl>
<dl class="section author"><dt>Author</dt><dd>Main contributors (see contributors.h for copyright, address and affiliation details)<ul>
<li>Stephan Wenger <a href="#" onclick="location.href='mai'+'lto:'+'ste'+'we'+'@cs'+'.t'+'u-b'+'er'+'lin'+'.d'+'e'; return false;">stewe<span style="display: none;">.nosp@m.</span>@cs.<span style="display: none;">.nosp@m.</span>tu-be<span style="display: none;">.nosp@m.</span>rlin<span style="display: none;">.nosp@m.</span>.de</a> </li>
</ul>
</dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8c2ef325f78e6851fba3ed4032be8c50"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c2ef325f78e6851fba3ed4032be8c50">&#9670;&nbsp;</a></span>FillParameterSetStructures()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FillParameterSetStructures </td>
          <td>(</td>
          <td class="paramtype">seq_parameter_set_rbsp_t *&#160;</td>
          <td class="paramname"><em>sps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pic_parameter_set_rbsp_t *&#160;</td>
          <td class="paramname"><em>pps</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>FillParameterSetStructures: extracts info from global variables and generates a picture and sequence parameter set structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sps</td><td>Sequence parameter set to be filled </td></tr>
    <tr><td class="paramname">pps</td><td>Picture parameter set to be filled </td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt></dt><dd>Function reads all kinds of values from several global variables, including input-&gt; and image-&gt; and fills in the sps and pps. Many values are current hard-coded to defaults, especially most of the VUI stuff. Currently, the sps and pps structures are fixed length with the exception of the fully flexible FMO map (mode 6). This mode is not supported. Hence, the function does not need to allocate memory for the FMOmap, the pointer slice_group_id is always NULL. If one wants to implement FMO mode 6, one would need to malloc the memory for the map here, and the caller would need to free it after use.</dd></dl>
<dl class="section user"><dt></dt><dd>Limitations Currently, the encoder does not support multiple parameter sets, primarily because the config file does not support it. Hence the pic_parameter_set_id and the seq_parameter_set_id are always zero. If one day multiple parameter sets are implemented, it would make sense to break this function into two, one for the picture and one for the sequence. Currently, FMO is not supported The following pps and sps elements seem not to be used in the encoder or decoder and, hence, a guessed default value is conveyed:</dd></dl>
<p>pps-&gt;num_ref_idx_l0_active_minus1 = img-&gt;num_ref_pic_active_fwd_minus1; pps-&gt;num_ref_idx_l1_active_minus1 = img-&gt;num_ref_pic_active_bwd_minus1; pps-&gt;chroma_qp_index_offset = 0; sps-&gt;required_frame_num_update_behaviour_flag = FALSE; sps-&gt;direct_temporal_constrained_flag = FALSE;</p>
<dl class="section user"><dt></dt><dd>Regarding the QP The previous software versions coded the absolute QP only in the slice header. This is kept, and the offset in the PPS is coded even if we could save bits by intelligently using this field. </dd></dl>
<p>POC stuff: The following values are hard-coded in <a class="el" href="lencod_8c.html#a6190a603712b3dc9c878f54a8f7b325b" title="Initializes the POC structure with appropriate parameters.">init_poc()</a>. Apparently, the poc implementation covers only a subset of the poc functionality. Here, the same subset is implemented. Changes in the POC stuff have also to be reflected here</p>
<p>Following set the parameter for different slice group types</p>

</div>
</div>
<a id="a2a31602a3ebbedf60e8963bf1bd8e1be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a31602a3ebbedf60e8963bf1bd8e1be">&#9670;&nbsp;</a></span>FreeParameterSets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void FreeParameterSets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>frees global parameter sets active_sps and active_pps </p>
<dl class="section return"><dt>Returns</dt><dd>A NALU containing the Sequence ParameterSet </dd></dl>

</div>
</div>
<a id="a4f3d2bb7e7970f24b1f5c2e86aefabcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f3d2bb7e7970f24b1f5c2e86aefabcb">&#9670;&nbsp;</a></span>GenerateParameterSets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenerateParameterSets </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>generates a sequence and picture parameter set and stores these in global active_sps and active_pps </p>
<dl class="section return"><dt>Returns</dt><dd>A NALU containing the Sequence ParameterSet </dd></dl>

</div>
</div>
<a id="a4cf018768a067fec68b97e027ecd3819"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cf018768a067fec68b97e027ecd3819">&#9670;&nbsp;</a></span>GeneratePic_parameter_set_NALU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NALU_t* GeneratePic_parameter_set_NALU </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>NALU_t *GeneratePic_parameter_set_NALU ();. </p>
<dl class="section note"><dt>Note</dt><dd>Uses the global variables through <a class="el" href="parset_8c.html#a8c2ef325f78e6851fba3ed4032be8c50" title="FillParameterSetStructures: extracts info from global variables and generates a picture and sequence ...">FillParameterSetStructures()</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>A NALU containing the Picture Parameter Set </dd></dl>

</div>
</div>
<a id="af4306d13e672a745606a9793df4b18d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af4306d13e672a745606a9793df4b18d5">&#9670;&nbsp;</a></span>GeneratePic_parameter_set_rbsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GeneratePic_parameter_set_rbsp </td>
          <td>(</td>
          <td class="paramtype">pic_parameter_set_rbsp_t *&#160;</td>
          <td class="paramname"><em>pps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>rbsp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>int GeneratePic_parameter_set_rbsp (pic_parameter_set_rbsp_t *sps, char *rbsp); </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pps</td><td>picture parameter structure </td></tr>
    <tr><td class="paramname">rbsp</td><td>buffer to be filled with the rbsp, size should be at least MAXIMUMPARSETRBSPSIZE</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size of the RBSP in bytes, negative in case of an error</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Picture Parameter VUI function is called, but the function implements an exit (-1) </dd></dl>

</div>
</div>
<a id="a2758c89416acfb769f1fdd74e750ee1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2758c89416acfb769f1fdd74e750ee1b">&#9670;&nbsp;</a></span>GenerateSeq_parameter_set_NALU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">NALU_t* GenerateSeq_parameter_set_NALU </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>int GenerateSeq_parameter_set_NALU (); </p>
<dl class="section note"><dt>Note</dt><dd>Uses the global variables through <a class="el" href="parset_8c.html#a8c2ef325f78e6851fba3ed4032be8c50" title="FillParameterSetStructures: extracts info from global variables and generates a picture and sequence ...">FillParameterSetStructures()</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>A NALU containing the Sequence ParameterSet </dd></dl>

</div>
</div>
<a id="aa54abd2ecf70d3d51ef613387e5dba91"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54abd2ecf70d3d51ef613387e5dba91">&#9670;&nbsp;</a></span>GenerateSeq_parameter_set_rbsp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int GenerateSeq_parameter_set_rbsp </td>
          <td>(</td>
          <td class="paramtype">seq_parameter_set_rbsp_t *&#160;</td>
          <td class="paramname"><em>sps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>rbsp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>int GenerateSeq_parameter_set_rbsp (seq_parameter_set_rbsp_t *sps, char *rbsp); </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sps</td><td>sequence parameter structure </td></tr>
    <tr><td class="paramname">rbsp</td><td>buffer to be filled with the rbsp, size should be at least MAXIMUMPARSETRBSPSIZE</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>size of the RBSP in bytes</dd></dl>
<dl class="section note"><dt>Note</dt><dd>Sequence Parameter VUI function is called, but the function implements an exit (-1) </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.8.19
</small></address>
</body>
</html>
